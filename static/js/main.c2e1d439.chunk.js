(this["webpackJsonpgoogle-weather-copy"]=this["webpackJsonpgoogle-weather-copy"]||[]).push([[0],{13:function(t,e,n){t.exports={current:"CurrentWeather_current__3eoIk",leftCol:"CurrentWeather_leftCol__3OQxZ",temp:"CurrentWeather_temp__3W1Vd",btns:"CurrentWeather_btns__AZ7d7",btn:"CurrentWeather_btn__Oh3m-",active:"CurrentWeather_active__tCyXI",vertLine:"CurrentWeather_vertLine__3lqeN",other:"CurrentWeather_other__quPtP",rightCol:"CurrentWeather_rightCol__t55u-",btnFindLoc:"CurrentWeather_btnFindLoc__1LIEj",location:"CurrentWeather_location__pkGnp",findWrapper:"CurrentWeather_findWrapper__1a7QJ",findInput:"CurrentWeather_findInput__3L8z8",findList:"CurrentWeather_findList__QGo5A",findItem:"CurrentWeather_findItem__aoEil"}},183:function(t,e,n){},294:function(t,e,n){"use strict";n.r(e);var a,r=n(1),c=n.n(r),i=n(44),s=n.n(i),o=(n(182),n(183),n(11)),u=n(20),d=n(13),l=n.n(d),h=n(5),f=function(t){var e=t.size,n=void 0===e?24:e,a=t.fill,r=void 0===a?"#fbbc04":a;return Object(h.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",style:{margin:"0 10px 0 0"},width:n,height:n,viewBox:"0 0 24 24",children:Object(h.jsx)("path",{fill:r,d:"M12 0c-4.198 0-8 3.403-8 7.602 0 4.198 3.469 9.21 8 16.398 4.531-7.188 8-12.2 8-16.398 0-4.199-3.801-7.602-8-7.602zm0 11c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z"})})},p=Object(r.memo)(f),j=n(51),m=n.n(j),b=n(89),x=n(52),O=n(29),y=Object(O.b)("data/fetchWeather",function(){var t=Object(b.a)(m.a.mark((function t(e,n){var a,r,c,i,s,o;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.rejectWithValue,r=Object(u.a)(e,2),c=r[0],i=r[1],s="https://api.weatherapi.com/v1/forecast.json?key=b8d348df879e486ca0f172620210610&q=".concat(c,",").concat(i,"&days=8&lang=ru"),t.prev=3,t.next=6,fetch(s);case 6:if((o=t.sent).ok){t.next=9;break}throw new Error("Server Error!");case 9:return t.next=11,o.json();case 11:return t.abrupt("return",t.sent);case 14:return t.prev=14,t.t0=t.catch(3),t.abrupt("return",a(t.t0.message));case 17:case"end":return t.stop()}}),t,null,[[3,14]])})));return function(e,n){return t.apply(this,arguments)}}()),_=Object(O.c)({name:"data",initialState:{data:{},statusFetchWeather:null,errorFetchWeather:null},extraReducers:(a={},Object(x.a)(a,y.pending,(function(t){t.statusFetchWeather="loading"})),Object(x.a)(a,y.fulfilled,(function(t,e){t.data=e.payload,t.statusFetchWeather="ok"})),Object(x.a)(a,y.rejected,(function(t,e){t.errorFetchWeather=e.payload,t.statusFetchWeather="rejected"})),a)}).reducer,v=Object(O.c)({name:"currWeather",initialState:{currData:{},isMetric:!0,isAutoLocation:!1},reducers:{setCurrData:function(t,e){var n=e.payload.data,a=n.current;t.currData=g(n,a,a.last_updated)},setForecastData:function(t,e){var n,a=Object(u.a)(e.payload,2),r=a[0],c=a[1];t.currData.updTimeStamp!==r&&(c.forecast.forecastday.forEach((function(t){return t.hour.forEach((function(t){new Date(t.time).getTime()===r&&(n=t)}))})),t.currData=g(c,n,n.time))},setCurrDayData:function(t,e){var n=Object(u.a)(e.payload,3),a=n[0],r=n[1],c=n[2];t.currData.updTimeStamp!==a&&(t.currData=g(c,r,a,!0))},setMetric:function(t,e){t.isMetric=e.payload},setAutoLocation:function(t,e){t.isAutoLocation=e.payload}}});function g(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={weekday:"long",hour:a?void 0:"numeric",minute:a?void 0:"numeric"};return{temp_c:Math.round(a?e.avgtemp_c:e.temp_c),temp_f:Math.round(a?e.avgtemp_f:e.temp_f),icon:e.condition.icon,precip_mm:a?e.totalprecip_mm:e.precip_mm,humidity:a?e.avghumidity:e.humidity,wind_kph:Math.round(a?e.maxwind_kph:e.wind_kph),wind_mph:Math.round(a?e.maxwind_mph:e.wind_mph),country:t.location.country,name:t.location.name,text:e.condition.text,updTime:new Intl.DateTimeFormat("ru-RU",r).format(new Date(n)),updTimeStamp:new Date(n).getTime()}}var w=v.actions,k=w.setCurrData,C=w.setForecastData,D=w.setMetric,W=w.setCurrDayData,N=w.setAutoLocation,S=v.reducer,M=function(){var t=Object(o.b)();function e(){return(e=Object(b.a)(m.a.mark((function t(e,n,a,r){var c,i;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n("loading"),c="https://api.weatherapi.com/v1/search.json?key=b8d348df879e486ca0f172620210610&q=".concat(e),t.prev=2,t.next=5,fetch(c);case 5:if((i=t.sent).ok){t.next=8;break}throw new Error("Server Error!");case 8:return t.t0=a,t.next=11,i.json();case 11:t.t1=t.sent,(0,t.t0)(t.t1),n("ok"),t.next=20;break;case 16:t.prev=16,t.t2=t.catch(2),r(t.t2.message),n("error");case 20:case"end":return t.stop()}}),t,null,[[2,16]])})))).apply(this,arguments)}return{getUrPosition:function(){navigator.geolocation.getCurrentPosition((function(e){t(y([e.coords.latitude,e.coords.longitude])),t(N(!0))}),(function(e){return t(y([34.052235,-118.243683]))}),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})},fetchNewWeather:function(e,n,a){t(y([n,a])),e.target.value="",t(N(!1))},fetchLocation:function(t,n,a,r){return e.apply(this,arguments)}}},A=function(t){var e=t.isVisible,n=M(),a=n.fetchNewWeather,c=n.fetchLocation,i=Object(r.useRef)(),s=Object(r.useState)([]),o=Object(u.a)(s,2),d=o[0],f=o[1],p=Object(r.useState)(null),j=Object(u.a)(p,2),m=j[0],b=j[1],x=Object(r.useState)(null),O=Object(u.a)(x,2),y=O[0],_=O[1];function v(t,e){"Enter"!==t.code&&"click"!==t.type||a(t,e.lat,e.lon)}return Object(r.useLayoutEffect)((function(){e&&i.current.focus()}),[]),Object(h.jsxs)("div",{className:"".concat(l.a.findWrapper," js-findWrapper"),children:[Object(h.jsx)("h3",{children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043d\u0430\u0441\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u0443\u043d\u043a\u0442\u0430"}),Object(h.jsx)("input",{className:l.a.findInput,ref:i,onChange:function(t){var e;(e=t.target.value).length>2&&c(e,_,f,b)},placeholder:"\u041f\u043e\u0438\u0441\u043a \u043e\u0442 3 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432",type:"text",name:"country-name"}),Object(h.jsxs)("ul",{tabIndex:0,className:l.a.findList,children:["loading"===y&&Object(h.jsx)("li",{className:l.a.findItem,children:"loading..."}),d.length>0&&"ok"===y&&d.map((function(t){return Object(h.jsx)("li",{className:l.a.findItem,tabIndex:0,onClick:function(e){return v(e,t)},onKeyUp:function(e){return v(e,t)},children:t.name},t.id)})),0===d.length&&"ok"===y&&Object(h.jsx)("li",{className:l.a.findItem,children:"\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"}),"error"===y&&Object(h.jsx)("li",{className:l.a.findItem,children:m})]})]})},E=function(t){var e=t.isOpen,n=t.onClose,a=t.children,r=t.childrenClassName;if(!e)return null;function c(t){t.target.closest(".".concat(r))&&"Escape"!==t.code||n()}return Object(i.createPortal)(Object(h.jsx)("div",{className:"modal",onClick:c,onKeyUp:c,children:a}),document.body)},L=function(){var t=Object(o.c)((function(t){return t.currWeather})),e=t.isMetric,n=t.currData,a=t.isAutoLocation,c=Object(o.c)((function(t){return t.data})).data,i=Object(r.useState)(!1),s=Object(u.a)(i,2),d=s[0],f=s[1],j=n.temp_c,m=n.temp_f,b=n.icon,x=n.precip_mm,O=n.humidity,y=n.wind_kph,_=n.wind_mph,v=n.country,g=n.name,w=n.text,C=n.updTime,W=Object(o.b)();return Object(r.useEffect)((function(){W(k({data:c}))}),[c]),Object(h.jsxs)("div",{className:l.a.current,children:[Object(h.jsxs)("div",{className:l.a.leftCol,children:[Object(h.jsx)("img",{width:64,height:64,src:b,alt:"weather icon"}),Object(h.jsx)("span",{className:l.a.temp,children:e?j:m}),Object(h.jsxs)("div",{className:l.a.btns,children:[Object(h.jsx)("button",{disabled:e,onClick:function(){return W(D(!0))},className:"".concat(l.a.btn," ").concat(e?l.a.active:""),children:"\xb0C"}),Object(h.jsx)("span",{className:l.a.vertLine,children:"|"}),Object(h.jsx)("button",{disabled:!e,onClick:function(){return W(D(!1))},className:"".concat(l.a.btn," ").concat(e?"":l.a.active),children:"\xb0F"})]}),Object(h.jsxs)("ul",{className:l.a.other,children:[Object(h.jsxs)("li",{children:["\u041e\u0441\u0430\u0434\u043a\u0438: ",x," \u043c\u043c"]}),Object(h.jsxs)("li",{children:["\u0412\u043b\u0430\u0436\u043d\u043e\u0441\u0442\u044c: ",O,"%"]}),Object(h.jsxs)("li",{children:["\u0412\u0435\u0442\u0435\u0440: ",e?"".concat(y," \u043a\u043c/\u0447"):"".concat(_," \u043c\u0438/\u0447")]})]})]}),Object(h.jsxs)("div",{className:l.a.rightCol,children:[Object(h.jsxs)("button",{onClick:function(){return f(!0)},className:l.a.btnFindLoc,children:[a&&Object(h.jsx)(p,{size:20}),Object(h.jsxs)("h1",{className:l.a.location,children:[v,", ",g]})]}),Object(h.jsx)("span",{children:C}),Object(h.jsx)("span",{children:w}),Object(h.jsx)(E,{childrenClassName:"js-findWrapper",isOpen:d,onClose:function(){return f(!1)},children:Object(h.jsx)(A,{isVisible:d})})]})]})},Y=n(163),F=Object(O.c)({name:"graph",initialState:{dataXY:[],typeY:"temp_c",tickValues:[],last_updated:null,slideGraphicsPx:null,minY:-1},reducers:{getXY:function(t,e){var n,a=[],r=Object(Y.a)(e.payload.data.forecast.forecastday);try{for(r.s();!(n=r.n()).done;){n.value.hour.forEach((function(t){a.push({time:new Date(t.time).getTime(),temp_c:Math.round(t.temp_c),temp_f:Math.round(t.temp_f),humidity:Math.round(t.humidity),wind_kph:Math.round(t.wind_kph),wind_mph:Math.round(t.wind_mph),wind_degree:t.wind_degree})}))}}catch(c){r.e(c)}finally{r.f()}t.dataXY=a},getArrHours:function(t){var e=new Date(t.last_updated).getHours();++e;var n=[];t.dataXY.forEach((function(t,a){for(var r=e;r<75;r+=3){a===r&&n.push(t.time);for(var c=e;c>=0;c-=3)a===c&&n.push(t.time)}})),t.tickValues=n},setCurrUpdTime:function(t,e){t.last_updated=e.payload.data.current.last_updated},setType:function(t,e){t.typeY=e.payload},setSlideGraphics:function(t,e){var n=e.payload,a=new Date(n).getTime(),r=new Date(t.last_updated).getTime();a<r&&(a=r);var c=650*((a-t.dataXY[0].time)/36e5-2.9)/24;c>1275&&(c=1275),c<0&&(c=0),t.slideGraphicsPx=c},getMinY:function(t,e){t.minY=t.dataXY.reduce((function(e,n){return e>=n[t.typeY]&&(e=n[t.typeY]-1),e}),-1)}}}),T=F.actions,V=(T.resetGraphicsStates,T.getXY),I=T.setSlideGraphics,z=T.getArrHours,P=(T.getVisualY,T.setCurrUpdTime),X=T.setType,G=T.getMinY,U=F.reducer,H=function(){var t=Object(o.c)((function(t){return t.currWeather})).isMetric,e=Object(o.c)((function(t){return t.graphics})).typeY,n=Object(o.b)();function a(a,r){e!==a&&(e.includes("".concat(a))||(r.target.parentElement.querySelectorAll("button").forEach((function(t){return t.className=""})),r.target.classList.add("active"),n(X("temp"!==a?"wind"!==a?a:"".concat(t?"wind_kph":"wind_mph"):"".concat(t?"temp_c":"temp_f")))))}return Object(h.jsxs)("div",{className:"type-btns",children:[Object(h.jsx)("button",{className:"active",onClick:function(t){return a("temp",t)},children:"\u0422\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u0430"}),Object(h.jsx)("span",{className:"vert-line",children:"|"}),Object(h.jsx)("button",{onClick:function(t){return a("humidity",t)},children:"\u0412\u043b\u0430\u0436\u043d\u043e\u0441\u0442\u044c"}),Object(h.jsx)("span",{className:"vert-line",children:"|"}),Object(h.jsx)("button",{onClick:function(t){return a("wind",t)},children:"\u0412\u0435\u0442\u0435\u0440"})]})},q=n(302),B=n(154),R=n(303),J=n(304),Q=n(156),K=n(300),Z=function(){var t=Object(o.c)((function(t){return t.data})).data,e=Object(o.c)((function(t){return t.graphics})).typeY;return{getVisualY:function(n){function a(){if(e.includes("temp"))return n[e];switch(e){default:return n[e];case"humidity":return"".concat(n[e],"%");case"wind_kph":return"".concat(n[e]," \u043a\u043c/\u0447");case"wind_mph":return"".concat(n[e]," \u043c\u0438/\u0447")}}var r=new Date(t.current.last_updated).getHours(),c=new Date(n.time).getHours();e.includes("temp")||++r;for(var i=r;i<27;i+=3){if(c===i)return a();for(var s=r;s>=0;s-=3)if(c===s)return a()}},chartsStyles:{VictoryAxis:{tickLabels:{fontFamily:"Arial",fontSize:12,fill:"#70757a"},axis:{stroke:null}},VictoryArea:{data:{fill:"".concat("humidity"===e?"#e8f0fe":"#fff5cc"),stroke:"".concat("humidity"===e?"#1a73e8":"#ffcc00"),strokeWidth:2},labels:{fontFamily:"Arial",fontSize:11,fontWeight:700,fill:"".concat("humidity"===e?"#1a73e8":"rgb(181, 181, 181)"),cursor:"pointer"}}}}},$=function(t){var e=t.datum,n=t.x,a=t.dx,r=t.y,c=t.dy,i=t.style,s=Object(o.c)((function(t){return t.data.data})),u=Object(o.c)((function(t){return t.currWeather})).currData,d=Object(o.b)(),l=Z().getVisualY;return Object(h.jsxs)("g",{onClick:function(){return d(C([e.time,s]))},style:i,x:n,y:l(e),children:[Object(h.jsx)("rect",{vectorEffect:"non-scaling-stroke",height:"85",width:650/24,x:n,fill:"transparent",y:r-25}),Object(h.jsx)("text",{style:{fill:new Date(u.updTimeStamp).setMinutes(0)===e.time?"rgb(85, 85, 85)":"inherit"},x:n+a,y:r,dy:c,children:Object(h.jsx)("tspan",{children:l(e)})})]})},tt=function(t){var e=t.x,n=t.y,a=t.datum,r=t.text,c=Object(o.c)((function(t){return t.data.data})),i=Object(o.b)();return Object(h.jsx)("text",{x:e,y:n,children:Object(h.jsx)("tspan",{onClick:function(){return i(C([a,c]))},style:{fontSize:12,fill:"#70757a"},x:e,children:r})})},et=function(t){var e=t.x,n=(t.y,t.dx),a=t.datum,r=Object(o.c)((function(t){return t.graphics})).tickValues,c=a.wind_degree,i=a.wind_kph,s=a.time;return r.includes(s)?(i<10&&(i=10),Object(h.jsx)("svg",{x:e-(i+5)/2+n,y:53,children:Object(h.jsx)("svg",{x:"0px",y:"0px",width:"".concat(i,"px"),height:"42px",viewBox:"0 0 42 42",enableBackground:"new 0 0 42 42",children:Object(h.jsx)("polygon",{fill:"#AEBFCF",style:{transformOrigin:"50% 50%",transform:"rotate(".concat(c-90,"deg)")},points:"27,37.5 42,20 27,4.5 18,4.5 30,16.5 0,16.5 0,23.5 30,23.5 18,37.5 "})})})):null},nt=function(){var t=Object(o.c)((function(t){return t.data})).data,e=Object(o.c)((function(t){return t.graphics})),n=e.dataXY,a=e.slideGraphicsPx,c=e.typeY,i=e.tickValues,s=e.minY,u=Object(o.c)((function(t){return t.currWeather})).isMetric,d=Object(o.b)(),l=Z(),f=l.getVisualY,p=l.chartsStyles;return Object(r.useEffect)((function(){d(V({data:t})),d(P({data:t})),d(z()),d(I(t.current.last_updated))}),[t]),Object(r.useEffect)((function(){c.includes("temp")&&d(X("".concat(u?"temp_c":"temp_f"))),c.includes("wind")&&d(X("".concat(u?"wind_kph":"wind_mph")))}),[u]),Object(r.useEffect)((function(){d(G())}),[n]),Object(h.jsxs)(q.a,{width:1925,height:125,padding:{bottom:20,top:25,left:0,right:0},domainPadding:{y:[15,25]},containerComponent:Object(h.jsx)(B.a,{style:{transform:"translateX(-".concat(a,"px)"),transition:"all 1000ms cubic-bezier(.51,-0.17,0,1)"},responsive:!1}),children:[Object(h.jsx)(R.a,{name:"VictoryAxis",crossAxis:!1,tickValues:i,tickFormat:function(t){return"".concat(new Date(t).getHours(),":00")},style:p.VictoryAxis,tickLabelComponent:Object(h.jsx)(tt,{y:123})}),c.includes("wind")?Object(h.jsx)(J.a,{name:"windChart",data:n,x:"time",style:{labels:{fontFamily:"Arial, sans-serif",fontSize:12,stroke:void 0}},labels:function(t){var e=t.datum;return f(e)},dataComponent:Object(h.jsx)(et,{dx:15}),labelComponent:Object(h.jsx)(Q.a,{dx:15,y:35})}):Object(h.jsx)(K.a,{name:"chart",y0:function(){return s},interpolation:"humidity"===c?"step":"basis",style:p.VictoryArea,data:n,x:"time",y:c,labels:function(t){var e=t.datum;return f(e)},labelComponent:Object(h.jsx)($,{y:c.includes("temp")?void 0:45,dx:c.includes("temp")?8:2,dy:-10})})]})},at=function(t){var e=t.currData,n=t.isMetric,a=Object(o.c)((function(t){return t.data})).data,r=Object(o.b)();function c(t){var c=t.day,i=c.maxtemp_c,s=c.maxtemp_f,o=c.mintemp_c,d=c.mintemp_f,l=t.day.condition,f=l.icon,p=l.text,j=new Date(e.updTimeStamp).getDate()===new Date(t.date).getDate();var m=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.map((function(t){return Math.round(t)}))}(i,s,o,d),b=Object(u.a)(m,4);return i=b[0],s=b[1],o=b[2],d=b[3],Object(h.jsxs)("button",{onClick:function(e){return function(t,e,n){if(!n){var c=t.target.closest("button");c.parentElement.querySelectorAll("button").forEach((function(t){return t.classList.remove("active")})),c.classList.add("active"),r(I(e.date)),r(W([e.date,e.day,a]))}}(e,t,j)},className:"day-btn ".concat(j?"active":""),children:[Object(h.jsxs)("div",{children:[" ",new Intl.DateTimeFormat("ru-RU",{weekday:"short"}).format(new Date(t.date))]}),Object(h.jsx)("img",{width:64,height:64,src:f,alt:p}),Object(h.jsx)("br",{}),Object(h.jsxs)("span",{children:["\xa0\xa0","".concat(n?i:s),"\xb0\xa0"]}),Object(h.jsxs)("span",{className:"day-btn__f",children:["".concat(n?o:d),"\xb0"]})]},t.date)}return Object(h.jsx)("div",{className:"day-btns",children:a.forecast.forecastday.map((function(t){return c(t)}))})};function rt(t,e){var n=new Date(t.currData.updTimeStamp).getDay()===new Date(e.currData.updTimeStamp).getDay();return t.isMetric===e.isMetric&&n}var ct=Object(r.memo)(at,rt);var it=function(){var t=Object(o.c)((function(t){return t.data})),e=t.errorFetchWeather,n=t.statusFetchWeather,a=Object(o.c)((function(t){return t.currWeather})),c=a.currData,i=a.isMetric,s=M().getUrPosition;return Object(r.useEffect)((function(){s()}),[]),Object(h.jsxs)("div",{className:"App",children:["loading"===n&&Object(h.jsx)("h2",{children:"loading..."}),e&&Object(h.jsxs)("h2",{style:{color:"red"},children:["\u041e\u0448\u0438\u0431\u043a\u0430: ",e]}),"ok"===n&&!e&&Object(h.jsxs)("div",{className:"container",children:[Object(h.jsx)(L,{}),Object(h.jsx)(H,{}),Object(h.jsx)("div",{className:"charts",children:Object(h.jsx)(nt,{})}),Object(h.jsx)(ct,{currData:c,isMetric:i})]})]})},st=Object(O.a)({reducer:{data:_,graphics:U,currWeather:S}});s.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(o.a,{store:st,children:Object(h.jsx)(it,{})})}),document.getElementById("root"))}},[[294,1,2]]]);
//# sourceMappingURL=main.c2e1d439.chunk.js.map