(this["webpackJsonpgoogle-weather-copy"]=this["webpackJsonpgoogle-weather-copy"]||[]).push([[0],{13:function(t,e,n){t.exports={current:"CurrentWeather_current__3eoIk",leftCol:"CurrentWeather_leftCol__3OQxZ",temp:"CurrentWeather_temp__3W1Vd",btns:"CurrentWeather_btns__AZ7d7",btn:"CurrentWeather_btn__Oh3m-",active:"CurrentWeather_active__tCyXI",vertLine:"CurrentWeather_vertLine__3lqeN",other:"CurrentWeather_other__quPtP",rightCol:"CurrentWeather_rightCol__t55u-",btnFindLoc:"CurrentWeather_btnFindLoc__1LIEj",location:"CurrentWeather_location__pkGnp",findWrapper:"CurrentWeather_findWrapper__1a7QJ",findInput:"CurrentWeather_findInput__3L8z8",findList:"CurrentWeather_findList__QGo5A",findItem:"CurrentWeather_findItem__aoEil"}},183:function(t,e,n){},294:function(t,e,n){"use strict";n.r(e);var a,r=n(1),c=n.n(r),i=n(44),s=n.n(i),o=(n(182),n(183),n(11)),u=n(20),d=n(13),l=n.n(d),h=n(5),f=function(t){var e=t.size,n=void 0===e?24:e,a=t.fill,r=void 0===a?"#fbbc04":a;return Object(h.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",style:{margin:"0 10px 0 0"},width:n,height:n,viewBox:"0 0 24 24",children:Object(h.jsx)("path",{fill:r,d:"M12 0c-4.198 0-8 3.403-8 7.602 0 4.198 3.469 9.21 8 16.398 4.531-7.188 8-12.2 8-16.398 0-4.199-3.801-7.602-8-7.602zm0 11c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z"})})},p=Object(r.memo)(f),m=n(51),j=n.n(m),b=n(90),x=n(52),O=n(29),y=Object(O.b)("data/fetchWeather",function(){var t=Object(b.a)(j.a.mark((function t(e,n){var a,r,c,i,s,o;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.rejectWithValue,r=Object(u.a)(e,2),c=r[0],i=r[1],s="https://api.weatherapi.com/v1/forecast.json?key=b8d348df879e486ca0f172620210610&q=".concat(c,",").concat(i,"&days=8&lang=ru"),t.prev=3,t.next=6,fetch(s);case 6:if((o=t.sent).ok){t.next=9;break}throw new Error("Server Error!");case 9:return t.next=11,o.json();case 11:return t.abrupt("return",t.sent);case 14:return t.prev=14,t.t0=t.catch(3),t.abrupt("return",a(t.t0.message));case 17:case"end":return t.stop()}}),t,null,[[3,14]])})));return function(e,n){return t.apply(this,arguments)}}()),v=Object(O.c)({name:"data",initialState:{data:{},statusFetchWeather:null,errorFetchWeather:null},extraReducers:(a={},Object(x.a)(a,y.pending,(function(t){t.statusFetchWeather="loading"})),Object(x.a)(a,y.fulfilled,(function(t,e){t.data=e.payload,t.statusFetchWeather="ok"})),Object(x.a)(a,y.rejected,(function(t,e){t.errorFetchWeather=e.payload,t.statusFetchWeather="rejected"})),a)}).reducer,g=n(66),_=Object(O.c)({name:"currWeather",initialState:{currData:{},currLocation:{},isMetric:!0,isAutoLocation:!1},reducers:{setCurrData:function(t,e){var n=e.payload.data,a=n.current;t.currLocation={country:n.location.country,name:n.location.name},t.currData=w(a,a.last_updated)},setForecastData:function(t,e){var n=Object(u.a)(e.payload,2),a=n[0],r=n[1];if(t.currData.updTimeStamp!==a){var c,i,s=Object(g.a)(r.forecast.forecastday);try{t:for(s.s();!(i=s.n()).done;){var o,d=i.value,l=Object(g.a)(d.hour);try{for(l.s();!(o=l.n()).done;){var h=o.value;if(new Date(h.time).getTime()===a){c=h;break t}}}catch(f){l.e(f)}finally{l.f()}}}catch(f){s.e(f)}finally{s.f()}t.currData=w(c,c.time)}},setCurrDayData:function(t,e){var n=Object(u.a)(e.payload,2),a=n[0],r=n[1];t.currData.updTimeStamp!==a&&(t.currData=w(r,a,!0))},setMetric:function(t,e){t.isMetric=e.payload},setAutoLocation:function(t,e){t.isAutoLocation=e.payload}}});function w(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a={weekday:"long"};return n||(a.hour="numeric",a.minute="numeric"),{temp_c:Math.round(n?t.avgtemp_c:t.temp_c),temp_f:Math.round(n?t.avgtemp_f:t.temp_f),icon:t.condition.icon,precip_mm:n?t.totalprecip_mm:t.precip_mm,humidity:n?t.avghumidity:t.humidity,wind_kph:Math.round(n?t.maxwind_kph:t.wind_kph),wind_mph:Math.round(n?t.maxwind_mph:t.wind_mph),text:t.condition.text,updTime:new Intl.DateTimeFormat("ru-RU",a).format(new Date(e)),updTimeStamp:new Date(e).getTime()}}var k=_.actions,C=k.setCurrData,D=k.setForecastData,W=k.setMetric,N=k.setCurrDayData,L=k.setAutoLocation,S=_.reducer,Y=function(){var t=Object(o.c)();function e(){return(e=Object(b.a)(j.a.mark((function t(e,n,a,r){var c,i;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n("loading"),c="https://api.weatherapi.com/v1/search.json?key=b8d348df879e486ca0f172620210610&q=".concat(e),t.prev=2,t.next=5,fetch(c);case 5:if((i=t.sent).ok){t.next=8;break}throw new Error("Server Error!");case 8:return t.t0=a,t.next=11,i.json();case 11:t.t1=t.sent,(0,t.t0)(t.t1),n("ok"),t.next=20;break;case 16:t.prev=16,t.t2=t.catch(2),r(t.t2.message),n("error");case 20:case"end":return t.stop()}}),t,null,[[2,16]])})))).apply(this,arguments)}return{getUrPosition:function(){navigator.geolocation.getCurrentPosition((function(e){t(y([e.coords.latitude,e.coords.longitude])),t(L(!0))}),(function(){return t(y([34.052235,-118.243683]))}),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})},fetchNewWeather:function(e,n,a){t(y([n,a])),e.target.value="",t(L(!1))},fetchLocation:function(t,n,a,r){return e.apply(this,arguments)}}},A=function(t){var e=t.isVisible,n=Y(),a=n.fetchNewWeather,c=n.fetchLocation,i=Object(r.useRef)(),s=Object(r.useState)([]),o=Object(u.a)(s,2),d=o[0],f=o[1],p=Object(r.useState)(null),m=Object(u.a)(p,2),j=m[0],b=m[1],x=Object(r.useState)(null),O=Object(u.a)(x,2),y=O[0],v=O[1];function g(t,e){"Enter"!==t.code&&"click"!==t.type||a(t,e.lat,e.lon)}return Object(r.useLayoutEffect)((function(){e&&i.current.focus()}),[]),Object(h.jsxs)("div",{className:"".concat(l.a.findWrapper," js-findWrapper"),children:[Object(h.jsx)("h3",{children:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043d\u0430\u0441\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u0443\u043d\u043a\u0442\u0430"}),Object(h.jsx)("input",{className:l.a.findInput,ref:i,onChange:function(t){var e;(e=t.target.value).length>2&&c(e,v,f,b)},placeholder:"\u041f\u043e\u0438\u0441\u043a \u043e\u0442 3 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432",type:"text",name:"country-name"}),Object(h.jsxs)("ul",{tabIndex:0,className:l.a.findList,children:["loading"===y&&Object(h.jsx)("li",{className:l.a.findItem,children:"loading..."}),d.length>0&&"ok"===y&&d.map((function(t){return Object(h.jsx)("li",{className:l.a.findItem,tabIndex:0,onClick:function(e){return g(e,t)},onKeyUp:function(e){return g(e,t)},children:t.name},t.id)})),0===d.length&&"ok"===y&&Object(h.jsx)("li",{className:l.a.findItem,children:"\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"}),"error"===y&&Object(h.jsx)("li",{className:l.a.findItem,children:j})]})]})},M=function(t){var e=t.isOpen,n=t.onClose,a=t.children,r=t.childrenClassName;if(!e)return null;function c(t){t.target.closest(".".concat(r))&&"Escape"!==t.code||n()}return Object(i.createPortal)(Object(h.jsx)("div",{className:"modal",onClick:c,onKeyUp:c,children:a}),document.body)},F=Object(O.c)({name:"graph",initialState:{dataXY:[],typeY:"temp_c",tickValues:[],last_updated:null,slideGraphicsPx:null,minY:-1},reducers:{getXY:function(t,e){var n,a=[],r=Object(g.a)(e.payload.data.forecast.forecastday);try{for(r.s();!(n=r.n()).done;){n.value.hour.forEach((function(t){a.push({time:new Date(t.time).getTime(),temp_c:Math.round(t.temp_c),temp_f:Math.round(t.temp_f),humidity:Math.round(t.humidity),wind_kph:Math.round(t.wind_kph),wind_mph:Math.round(t.wind_mph),wind_degree:t.wind_degree})}))}}catch(c){r.e(c)}finally{r.f()}t.dataXY=a,t.last_updated=e.payload.data.current.last_updated},getArrHours:function(t){var e=new Date(t.last_updated).getHours()+1,n=[];t.dataXY.forEach((function(t,a){for(var r=e;r<75;r+=3){a===r&&n.push(t.time);for(var c=e;c>=0;c-=3)a===c&&n.push(t.time)}})),t.tickValues=n},setType:function(t,e){var n=e.payload;if("boolean"===typeof n)return t.typeY.includes("temp")&&(t.typeY=n?"temp_c":"temp_f"),void(t.typeY.includes("wind")&&(t.typeY=n?"wind_kph":"wind_mph"));t.typeY=n},setSlideGraphics:function(t,e){var n=e.payload,a=new Date(n).getTime(),r=new Date(t.last_updated).getTime();a<r&&(a=r);var c=650*((a-t.dataXY[0].time)/36e5-2.9)/24;c>1275&&(c=1275),c<0&&(c=0),t.slideGraphicsPx=c},getMinY:function(t){t.minY=t.dataXY.reduce((function(e,n){return e>=n[t.typeY]&&(e=n[t.typeY]-1),e}),-1)}}}),E=F.actions,V=(E.resetGraphicsStates,E.getXY),T=E.setSlideGraphics,I=E.getArrHours,P=(E.getVisualY,E.setType),z=E.getMinY,X=F.reducer,G=function(){var t=Object(o.d)((function(t){return t.currWeather})),e=t.isMetric,n=t.currData,a=t.isAutoLocation,c=t.currLocation,i=Object(o.d)((function(t){return t.data})).data,s=Object(r.useState)(!1),d=Object(u.a)(s,2),f=d[0],m=d[1],j=n.temp_c,b=n.temp_f,x=n.icon,O=n.precip_mm,y=n.humidity,v=n.wind_kph,g=n.wind_mph,_=n.text,w=n.updTime,k=c.country,D=c.name,N=Object(o.c)();function L(t){Object(o.b)((function(){N(W(t)),N(P(t))}))}return Object(r.useEffect)((function(){N(C({data:i}))}),[i,N]),Object(h.jsxs)("div",{className:l.a.current,children:[Object(h.jsxs)("div",{className:l.a.leftCol,children:[Object(h.jsx)("img",{width:64,height:64,src:x,alt:"weather icon"}),Object(h.jsx)("span",{className:l.a.temp,children:e?j:b}),Object(h.jsxs)("div",{className:l.a.btns,children:[Object(h.jsx)("button",{disabled:e,onClick:function(){return L(!0)},className:l.a.btn+"".concat(e?l.a.active:""),children:"\xb0C"}),Object(h.jsx)("span",{className:l.a.vertLine,children:"|"}),Object(h.jsx)("button",{disabled:!e,onClick:function(){return L(!1)},className:l.a.btn+"".concat(e?"":l.a.active),children:"\xb0F"})]}),Object(h.jsxs)("ul",{className:l.a.other,children:[Object(h.jsxs)("li",{children:["\u041e\u0441\u0430\u0434\u043a\u0438: ",O," \u043c\u043c"]}),Object(h.jsxs)("li",{children:["\u0412\u043b\u0430\u0436\u043d\u043e\u0441\u0442\u044c: ",y,"%"]}),Object(h.jsxs)("li",{children:["\u0412\u0435\u0442\u0435\u0440: ",e?"".concat(v," \u043a\u043c/\u0447"):"".concat(g," \u043c\u0438/\u0447")]})]})]}),Object(h.jsxs)("div",{className:l.a.rightCol,children:[Object(h.jsxs)("button",{onClick:function(){return m(!0)},className:l.a.btnFindLoc,children:[a&&Object(h.jsx)(p,{size:20}),Object(h.jsxs)("h1",{className:l.a.location,children:[k,", ",D]})]}),Object(h.jsx)("span",{children:w}),Object(h.jsx)("span",{children:_}),Object(h.jsx)(M,{childrenClassName:"js-findWrapper",isOpen:f,onClose:function(){return m(!1)},children:Object(h.jsx)(A,{isVisible:f})})]})]})},H=function(){var t=Object(o.d)((function(t){return t.currWeather})).isMetric,e=Object(o.d)((function(t){return t.graphics})).typeY,n=Object(o.c)();function a(a,r){e.includes(a)||(r.target.parentElement.querySelectorAll("button").forEach((function(t){return t.classList.remove("active")})),r.target.classList.add("active"),n(P("temp"!==a?"wind"!==a?a:"".concat(t?"wind_kph":"wind_mph"):"".concat(t?"temp_c":"temp_f"))))}return Object(h.jsxs)("div",{className:"type-btns",children:[Object(h.jsx)("button",{className:"active",onClick:function(t){return a("temp",t)},children:"\u0422\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u0430"}),Object(h.jsx)("span",{className:"vert-line",children:"|"}),Object(h.jsx)("button",{onClick:function(t){return a("humidity",t)},children:"\u0412\u043b\u0430\u0436\u043d\u043e\u0441\u0442\u044c"}),Object(h.jsx)("span",{className:"vert-line",children:"|"}),Object(h.jsx)("button",{onClick:function(t){return a("wind",t)},children:"\u0412\u0435\u0442\u0435\u0440"})]})},q=n(302),U=n(155),B=n(303),R=n(304),J=n(157),Q=n(300),K=function(){var t=Object(o.d)((function(t){return t.data})).data,e=Object(o.d)((function(t){return t.graphics})),n=e.typeY,a=e.slideGraphicsPx,r=Object(o.c)();return{getVisualY:function(e){function a(){if(n.includes("temp"))return e[n];var t="humidity"===n?"%":"wind_kph"===n?" \u043a\u043c/\u0447":"wind_mph"===n?" \u043c\u0438/\u0447":"";return e[n]+"".concat(t)}var r=new Date(t.current.last_updated).getHours(),c=new Date(e.time).getHours();n.includes("temp")||++r;for(var i=r;i<27;i+=3){if(c===i)return a();for(var s=r;s>=0;s-=3)if(c===s)return a()}},chartsStyles:{VictoryAxis:{tickLabels:{fontFamily:"Arial",fontSize:12,fill:"#70757a"},axis:{stroke:null}},VictoryArea:{data:{fill:"".concat("humidity"===n?"#e8f0fe":"#fff5cc"),stroke:"".concat("humidity"===n?"#1a73e8":"#ffcc00"),strokeWidth:2},labels:{fontFamily:"Arial",fontSize:11,fontWeight:700,fill:"".concat("humidity"===n?"#1a73e8":"rgb(181, 181, 181)"),cursor:"pointer"}},padding:{bottom:20,top:25,left:0,right:0},domainPadding:{y:[15,25]},VictoryContainer:{transform:"translateX(-".concat(a,"px)"),transition:"all 1000ms cubic-bezier(.51,-0.17,0,1)"}},onClick:{onClick:function(e){e.target.dataset.time&&r(D([+e.target.dataset.time,t]))}}}},Z=function(t){var e=t.datum,n=t.x,a=t.dx,r=t.y,c=t.dy,i=t.style,s=Object(o.d)((function(t){return t.currWeather})).currData,u=K().getVisualY;return Object(h.jsxs)("g",{style:i,x:n,y:u(e),children:[Object(h.jsx)("rect",{vectorEffect:"non-scaling-stroke",height:"85",width:650/24,x:n,fill:"transparent",y:r-25,"data-time":e.time}),Object(h.jsx)("text",{style:{fill:new Date(s.updTimeStamp).setMinutes(0)===e.time?"rgb(85, 85, 85)":"inherit"},x:n+a,y:r,dy:c,children:Object(h.jsx)("tspan",{"data-time":e.time,children:u(e)})})]})},$=function(t){var e=t.x,n=t.y,a=t.datum,r=t.text;return Object(h.jsx)("text",{x:e,y:n,children:Object(h.jsx)("tspan",{"data-time":a,style:{fontSize:12,fill:"#70757a"},x:e,children:r})})},tt=function(t){var e=t.x,n=t.dx,a=t.datum,r=Object(o.d)((function(t){return t.graphics})).tickValues,c=a.wind_degree,i=a.wind_kph,s=a.time;return r.includes(s)?(i<10&&(i=10),Object(h.jsx)("svg",{x:e-(i+5)/2+n,y:53,children:Object(h.jsx)("svg",{x:"0px",y:"0px",width:"".concat(i,"px"),height:"42px",viewBox:"0 0 42 42",enableBackground:"new 0 0 42 42",children:Object(h.jsx)("polygon",{fill:"#AEBFCF",style:{transformOrigin:"50% 50%",transform:"rotate(".concat(c-90,"deg)")},points:"27,37.5 42,20 27,4.5 18,4.5 30,16.5 0,16.5 0,23.5 30,23.5 18,37.5 "})})})):null},et=function(t){var e=t.data,n=Object(o.d)((function(t){return t.graphics})),a=n.dataXY,c=n.typeY,i=n.tickValues,s=n.minY,u=Object(o.c)(),d=K(),l=d.getVisualY,f=d.chartsStyles,p=d.onClick;return Object(r.useEffect)((function(){Object(o.b)((function(){u(V({data:e})),u(I()),u(T(e.current.last_updated)),u(z())}))}),[e]),Object(h.jsxs)(q.a,{width:1925,height:125,padding:f.padding,domainPadding:f.domainPadding,containerComponent:Object(h.jsx)(U.a,{events:p,style:f.VictoryContainer,responsive:!1}),children:[Object(h.jsx)(B.a,{name:"VictoryAxis",crossAxis:!1,tickValues:i,tickFormat:function(t){return"".concat(new Date(t).getHours(),":00")},style:f.VictoryAxis,tickLabelComponent:Object(h.jsx)($,{y:123})}),c.includes("wind")?Object(h.jsx)(R.a,{name:"windChart",data:a,x:"time",style:{labels:{fontFamily:"Arial, sans-serif",fontSize:12,stroke:void 0}},labels:function(t){var e=t.datum;return l(e)},dataComponent:Object(h.jsx)(tt,{dx:15}),labelComponent:Object(h.jsx)(J.a,{dx:15,y:35})}):Object(h.jsx)(Q.a,{name:"chart",y0:function(){return s},interpolation:"humidity"===c?"step":"basis",style:f.VictoryArea,data:a,x:"time",y:c,labels:function(t){var e=t.datum;return l(e)},labelComponent:Object(h.jsx)(Z,{y:c.includes("temp")?void 0:45,dx:c.includes("temp")?8:2,dy:-10})})]})},nt=function(){var t=Object(o.d)((function(t){return t.data})).data,e=Object(o.d)((function(t){return t.currWeather})),n=e.currData,a=e.isMetric,r=Object(o.c)();function c(t){var e=t.day,c=e.maxtemp_c,i=e.maxtemp_f,s=e.mintemp_c,o=e.mintemp_f,d=t.day.condition,l=d.icon,f=d.text,p=new Date(n.updTimeStamp).getDate()===new Date(t.date).getDate();var m=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.map((function(t){return Math.round(t)}))}(c,i,s,o),j=Object(u.a)(m,4);c=j[0],i=j[1],s=j[2],o=j[3];var b=new Intl.DateTimeFormat("ru-RU",{weekday:"short"}).format(new Date(t.date));return Object(h.jsxs)("button",{onClick:function(e){return function(t,e,n){if(!n){var a=t.target.closest("button");a.parentElement.querySelectorAll("button").forEach((function(t){return t.classList.remove("active")})),a.classList.add("active"),r(T(e.date)),r(N([e.date,e.day]))}}(e,t,p)},className:"day-btn ".concat(p?"active":""),children:[Object(h.jsx)("div",{children:b}),Object(h.jsx)("img",{width:64,height:64,src:l,alt:f}),Object(h.jsx)("br",{}),Object(h.jsxs)("span",{children:["\xa0\xa0","".concat(a?c:i),"\xb0\xa0"]}),Object(h.jsxs)("span",{className:"day-btn__f",children:["".concat(a?s:o),"\xb0"]})]},t.date)}return Object(h.jsx)("div",{className:"day-btns",children:t.forecast.forecastday.map((function(t){return c(t)}))})};function at(t,e){var n=new Date(t.currData.updTimeStamp).getDay()===new Date(e.currData.updTimeStamp).getDay();return t.isMetric===e.isMetric&&n}var rt=Object(r.memo)(nt,at);var ct=function(){var t=Object(o.d)((function(t){return t.data})),e=t.data,n=t.errorFetchWeather,a=t.statusFetchWeather,c=Y().getUrPosition;return Object(r.useEffect)((function(){c()}),[]),Object(h.jsxs)("div",{className:"App",children:["loading"===a&&Object(h.jsx)("h2",{children:"loading..."}),n&&Object(h.jsxs)("h2",{style:{color:"red"},children:["\u041e\u0448\u0438\u0431\u043a\u0430: ",n]}),"ok"===a&&!n&&Object(h.jsxs)("div",{className:"container",children:[Object(h.jsx)(G,{}),Object(h.jsx)(H,{}),Object(h.jsx)("div",{className:"charts",children:Object(h.jsx)(et,{data:e})}),Object(h.jsx)(rt,{})]})]})},it=Object(O.a)({reducer:{data:v,graphics:X,currWeather:S}});s.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(o.a,{store:it,children:Object(h.jsx)(ct,{})})}),document.getElementById("root"))}},[[294,1,2]]]);
//# sourceMappingURL=main.05673a55.chunk.js.map